# 复习

第一章

发展史理解

因特网的概念、好处

交换机、路由器重点，功能

分组交换中的延迟，四种延迟分清

为什么有体系结构重点，特点，分层

大概知道有哪几种威胁，怎么防。让你设计一下防范（我记得去年考画防护墙怎么连来着）

第二章

应用层基本原理/作用

web应用、HTTP怎么链接等

文件服务、邮件服务了解就行

DNS基本原理、两种查询、用的协议、作用

套接字：流程、函数

第三章 传输层是重点！！！

有哪些服务

理解一下多路复用、多路分解概念

3.3、3.4对比、优缺点

3.4那一堆演变过程的涉及的机制，比如校验和、流水线

TCP怎样处理丢包，拥塞控制的算法

吞吐量时延啥的不是重点

第四章

重点-IP协议，IPV4子网划分

路由算法Djstla、距离向量算法

第五章

链路层基本功能

差错检测技术及其优缺点，。第三个最重点。如校验和、奇偶校验、循环冗余校验，会算CRC

多路访问协议

交换机功能、基本原理

自学习、转发理解就行，三层也是

VLAN划分

***********

# 1 计算机和因特网

> 发展史理解
>
> 因特网的概念、好处
>
> 交换机、路由器重点，功能
>
> 分组交换中的延迟，四种延迟分清
>
> 为什么有体系结构重点，特点，分层
>
> 大概知道有哪几种威胁，怎么防。让你设计一下防范（我记得去年考画防护墙怎么连来着）

复习

* 计算机网络的定义
* 协议的定义和基本要素
* Internet的构成描述：
  * 具体构成：边缘（端系统，包括软件和硬件）、核心、接入网络和物理介质
  * 网络交换方式：电路和分组
  * 电路：时分和频分
  * 分组：数据报和虚电路
* 分组交换网络中的延迟及其计算
* TCP/IP的分层模型，各层PDU的名称和功能

## 1.1 发展史

分组交换原理早期→网际互联与新兴的专属网络→TCP/IP新协议与网络数量激增→商业化、web、新的网络应用→移动互联网

……

## 1.2 什么是Internet

计算机网络：两台以上具有独立操作系统的计算机通过某些介质连接成相互共享软硬件资源的集合体。计算机网络向用户提供最重要的两大功能是连通性、共享性

特点：松散分层；公用与专用；复杂、没有明确定义

构成：互联设备、通信链路、分组交换

提供的服务：为上层提供网络应用基础架构、为分布式应用程序提供通信服务接口

Internet：由网络构成的网络

* 提供的服务：提供网络应用基础架构，为分布式应用承租提供的通信服务接口

协议：定义了两个或多个通信实体间所叫唤你报文的格式和次序，以及在报文发送和接收或其它事件方面所采取的行动

通信控制→协议：定义格式和次序

* 协议基本要素：语法（<u>规定数据传输格式</u>）、语义、同步

## 1.3 网络边缘部分

端系统、客户和服务器

接入网络

* 家庭接入：点对点
* 企业接入：LAN
* WIFI无线接入
* 广域无线

物理介质：双绞线，同轴电缆和光纤线缆，无线电磁波

* 物理链路、引导型媒体、非引导型媒体
* 双绞线：两两相互缠绕，减少电磁干扰。性能非屏蔽>屏蔽；同轴电缆；光纤

接入网络：点对点、线缆调制解调器

> ISP-因特网服务的提供商，比如三大运营商

端系统上的服务

* 面向连接服务
* 无连接服务

## 1.4 网络核心部分

网络核心部分

* 基本原理
  * 电路交换：分片、多路复用（频分/时分多路复用）
  * 分组交换/包交换：统计复用-按需分配资源；拥塞、存储转发

电路交换：网络资源（如带宽）被分片，多路复用

* 频分多路复用FDM
* 时分多路复用TDM

分组交换/包交换：每个分组通过一系列链路和分组交换机传送，直到目的端，在目的端把接收到的分组，按顺序组装起来，恢复原报文。每个端到端的数据被划分成分组，所有分组共享网络资源，每个分组使用全部链路带宽，资源按需使用

* 虚电路网络：X.25、FR、ATM。每个分组有一个标签，标签决定下一条，连接建立时有固定路径且保持整个会话期间，路由器需为每个连接维护状态信息
* 数据报网络：TCP/IP。分组目的决定下一跳，会话期间路由可以改变如驱车逐段问路

> 虚电路网络一定是面向连接的；数据报网络既可以提供面向连接的服务如TCP，也可以提供无连接的服务如UDP

## 1.5 结构组成

ISP结构：一层-二层-三层ISP

## 1.6 延迟和吞吐量

> 这PPT还不如自己去年写的笔记上记得清楚，看这个：[计算机网络（未完）_Lyrisฅ的博客-CSDN博客](https://blog.csdn.net/qq_62076255/article/details/127412834?spm=1001.2014.3001.5501)

分组交换中的时延：

* 节点处理时延（用户→路由器，路由器需要检查处理）
* 排队时延：路由器内
* 传输时延：传输链路上
* 传播时延

往返时延就是总时间，从发送到接收

时延抖动、时延丢包

吞吐量：单位时间内整个网络传输数据的速率或分组数

PPT-114后有习题

## 1.7 协议层及其服务模型

> 看以前博客去

为什么要分层：

* 处理复杂的系统。清楚的结构允许我们对大型复杂系统定义其特定部分，探讨其各部分的关系
* 模块化使得系统的维护、升级简化，改变其某一层服务的具体实现对系统其余部分透明（不影响）
* 分层的弊端：各层可能重复较低层功能 ……

ISO/OSI参考模型：应用层、表示层、会话层、传输层、网络层、数据链路层、物理层

TCP/IP参考模型：应用层、传输层、网际层、网络接口层

五层：应用、运输、网络、数据链路、物理。（网际协议栈）

分层→逻辑通信：网络实体完成功能动作，对等实体交换信息

## 1.8 攻击威胁下的网络

攻击方式

* 植入恶意软件：病毒、蠕虫、僵尸网络
* 攻击服务器和网络基础设施：DoS-弱点攻击、带宽洪泛、连接洪泛
* 嗅探分组：分组嗅探器
* 伪装
* 修改或删除报文

***********

# 2 应用层

> 应用层基本原理/作用
>
> web应用、HTTP怎么链接等
>
> 文件服务、邮件服务了解就行
>
> DNS基本原理、两种查询、用的协议、作用
>
> 套接字：流程、函数

复习大纲

* 网络应用程序体系结构
* Web应用和HTTP协议
  * 基本术语（网页、URL等）
  * HTTP的特性及其区别(无状态、 非持久和持久等)
  * 请求和响应报文
  * COOKIE技术
  * Web缓存
* 文件传输协议FTP ：两种连接*
* 电子邮件：组成及其使用的协议
* DNS的功能和实现
* P2P文件共享原理和实现技术*
* CDN
* 构造简单的web服务器*

## 2.1 应用层协议原理

公共领域协议、专用协议

## 2.2 web应用和http协议

网页由许多对象组成。对象就是文件。多数网页由单个基本HTML文件和若干个所引用的对象构成。每个对象被一个URL（统一资源定位符）寻址

> HTTP是无状态协议

<u>每年考试重点：非持久（每个对象都要建立一个链接）/持久HTTP连</u>

HTTP：超文本传输协议

* 非持久HTTP协议连接：客户端初始化TCP连接，服务器端接受TCP请求并建立连接→客户端发送HTTP请求包含URL、TCP套接字、Web对象→服务器response→HTTP服务器结束TCP连接→客户端接收响应消息
  * 每个对象需要2个RTT，OS必须为每个TCP连接分配主机资源，大量客户的并发TCP连接形成服务器的严重负担
* 持久HTTP连接
  * 服务器发送响应消息后保持连接，后续HTTP消息继续在该连接上传送
  * 非流水线方式：客户端只能在前一个响应接受到之后才能发出新的请求→请求和接收都一个RTT，浪费服务器资源
  * 流水线方式：客户机可一个接一个连续产生请求→节省RTT时延
  * 默认方式：流水线方式的持久连接

> HTTP报文，注意最后回车换行表示结束

响应时间：

* 往返时间RTT：持续的——一次RTT、非持续的——三次RTT（开始、传输、结束各一次）
* 响应时间

HTTP/1.0、HTTP/1.1

响应信息、状态码：301-所请求对象永久迁移，400-该请求不能被服务器解读

Cookies

* coolie头部行在HTTP请求、响应消息中，cookie文件保存在用户主机中并被用户浏览器管理，cookie也保存在web站点的后端数据库

web缓存/代理服务器：

* 目标：代表起始服务器满足HTTP请求
* 作用：减少对客户机请求的响应时间，减少内部网络与接入链路上的通信量，能从整体上大大降低因特网上的web流量

> web缓存既是服务端也是客户端

## 2.3 文件传输协议FTP

传输文件到远程、从远程主机下载文件

向FTP服务器21端口发起TCP控制连接→身份认证→获取文件列表→文件传输命令，服务器20建立数据连接→传输结束连接关闭

建立方式：主动、被动

> 了解即可，不是考试范围
>
> 端口21是建立连接的，20才是传输数据的

## 2.4 电子邮件

组成：用户代理、邮件服务器、简单邮件传送协议和邮件接收协议

SMTP [RFC 5321] ：TCP、25端口，直接传送。SMTP协议。RFC 5321文本邮件消息格式标准

* 传输阶段：握手→邮件消息的传输→结束
* 传输：A的user agent写消息→A的邮件服务器→A的邮件服务器与B的邮件服务器握手、建立TCP连接→发送邮件消息→B的服务器存放消息到B的邮箱→B的user agent读邮件
* SMTP是持久连接，要求消息是7-bit ASCII。SMTP服务器用CRLF.CRLF判断邮件结束

POP3

* 身份认证阶段：客户端 `user username`、`pass password`，服务器 `+OK`、`-ERR`
* 传输阶段：列出邮件编号 `list`、按编号取邮件 `retr 1`、删除 `dele`、`quit`
* 会话是无状态的

IMAP：保存所有邮件消息在一个位置也就是服务器，允许用户在服务器的各文件夹中管理邮件消息，IMAP追踪用户会话状态信息

> SMTP发送邮件的协议
>
> POP3邮件访问协议
>
> IMAP接受邮件的协议

## 2.5 DNS

域名系统

功能：①主机名到IP地址的转换；②主机别名，一个主机可以有一个规范主机名和多个主机别名；③邮件服务器别名；④负载分配，DNS实现冗余服务器，一个IP地址集合可以对应同一规范主机名

分布式、层次数据库

根名字服务器、顶级域服务器、权威DNS服务器

查询方法

* 递归查询
* 迭代查询

DNS用UDP协议，端口53

## 2.6 P2P

这里标星号了，有时间再看

## 2.7 CDN

 如何从海量的视频中，挑选出某些内容，采用流的方式发送给成千上万的用户？将多份拷贝存储在地理上分散的不同站点来提供服务 （CDN）

CDN：将内容的拷贝存储在CDN节点中

用户向CDN请求内容：被定向到附近的拷贝，取得内容。如果网络路径拥塞，则可能选择其他的拷贝

## 2.8 构造web服务器

套接字

*************

# 3 传输层

> 有哪些服务
>
> 理解一下多路复用、多路分解概念
>
> 3.3、3.4对比、优缺点
>
> 3.4那一堆演变过程的涉及的机制，比如校验和、流水线
>
> TCP怎样处理丢包，拥塞控制的算法
>
> 吞吐量时延啥的不是重点

总结

* 传输层服务背后的原理
  * 多路复用, 多路分解
  * 可靠数据传输
  * 流控
  * 拥塞控制
* 因特网中的实例和实现
  * UDP
  * TCP
* 下面
  * 离开网络的 “边界” (应用层，传输层)
  * 进入网络 “核心”

## 3.1 传输层服务

应用层间的逻辑通信

可靠TCP，不可靠UDP

## 3.2 多路复用和多路分解

发送主机多路复用：从多个套接字收集数据、封装、传到网络层→接收主机多路分解接收到的数据段传递正确的套接字

多路分解：32bit报文——源端口、目的端口、应用程序数据 (报文)、 其他首部域

* 无连接的多路分解
* 面向连接的多路分解：TCP套接字（源IP地址 、源端口号、目的IP地址、目的端口号）

多路复用

## 3.3 无连接传输UDP

为什么有UDP：①不需要建立连接，减少延迟；②简单，在发送接收者之间不需要连接状态；③数据首部小；④没有拥塞控制，UDP能尽快的传输

UDP校验和：用于差错检测

UDP首部只有8字节。UDP报文可能有伪首部，用于计算校验和

## 3.4 可靠数据传输

有限状态机FSM

信道特性→可靠数据传输→Rdt 1.0→2.0、2.1、2.2→3.0→流水线与滑动窗口协议→GBN→SR

可靠：不错不丢不乱；可靠数据传输协议；信道的不可靠特性决定了可靠数据传输协议（rdt）的复杂性

rdt1.0：完全可靠信道上的可靠数据传输

* 在完美可靠的信道上，无bit错误页无分组丢失

rdt2.0：具有bit错误的信道

* 用校验和检测bit错误
* 新机制：差错检测；接收方反馈，ACK、NAK
* 停等协议：发送方发送一个报文然后等待接收方的响应
* 缺陷：ACK/NAK混淆→混淆时发送当前分组

rdt2.1：发送方/接收方处理混乱的ACK/NAKs

* 发送方序号加到分组上，用（0,1），接收方检查是否重复、序号。接收方不知道上一个ACK/NAK是否被发送方接收

rdt2.2：不要NAK的协议

* 和rdt2.1一样的功能但只用ACK，如果上个接收的ACK接收方必须明确包含被确认的报文序号，重复ACK就和NAK一样处理-重发

rdt3.0：具有出错和丢失的信道

* 假设下层信道还会丢失报文（数据/ACKs）
* 针对发送方设置合理的确认时间
* 停等操作流
* 流水线技术：发送方允许多个在路上还没确认的报文。序号数目范围↑，双方要有缓冲区。两个通用形式go-Back-N、选择重传
* go-Back-N：发送方中规定一个k位序列，设有窗口；接收方为正确接收的最高序号分组发ACK，接收到的失序分组丢弃，没有接收缓冲区
* 选择重传：双方都有缓冲区、窗口，发送方只重发没有收到确认的分组

各机制总结

| 机制         | 用途和说明                                                   |
| ------------ | ------------------------------------------------------------ |
| 校验和       | 用于检测在一个传输分组中的比特错误                           |
| 定时器       | 用于检测超时/重传一个分组，可能因为该分组（或其ACK）在信道中丢失了。由于当一个分组被时延但未丢失（过早超时），或当一个分组已被接收方收到但从接收方到发送方的ACK丢失时，可能产生超时事件，所以接收方可能会收到一个分组的多个冗余拷贝 |
| 序号         | 用于为从发送方流向接收方的数据分组按顺序编号。所接收分组的序号间的空隙可使该接收方检测出丢失的分组。具有相同序号的分组可使接收方检测出一个分组的冗余拷贝 |
| 确认         | 接收方用于告诉发送方一个分组或一组分组已被正确地接收到了。确认报文通常携带着被确认的分组或多个分组的序号。确认可以是逐个的或累积的，这取决于协议 |
| 否定确认     | 接收方用于告诉发送方某个分组未被正确地接收。否定确认报文通常携带着未被正确接收的分组的序号 |
| 窗口、流水线 | 发送方也许被限制仅发送那些序号落在一个指定范围内的分组。通过允许一次发送多个分组但未被确认，发送方的利用率可在停等操作模式的基础上得到增加。我们很快将会看到，窗口长度可根据接收方接收和缓存报文的能力或网络中的拥塞程度，或两者情况来进行设置 |

## 3.5 面向连接传输TCP

TCP序号-确认-累计ACK

失序数据段如何处理没明确规定，编程人员自行处理

往返时延的估计和超时

* 估计RTT：真是的RTT变化，需要样本RTT，EstimatedRTT=(1-α)×EstimatedRTT+α×SampleRTT，α一般0.125
* TCP超时一般设置比RTT长，太短会有不必要的重传，太长对数据段丢失响应慢
* DevRTT = (1-α)×DevRTT +β×|SampleRTT-EstimatedRTT|，一般β= 0.25。超时时间间隔：TimeoutInterval = EstimatedRTT + 4*DevRTT。
* 初始timeout设置为1s，获得第一个样本后 EstimatedRTT=SampleRTT， DevRTT=SampleRTT/2。TimeoutInterval =EstimatedRTT + max (G, K*DevRTT)，K=4，G是用户设置的时间粒度

可靠数据传输

快速重传算法

流量控制

连接管理、三次握手

## 3.6 拥塞个控制

表现为丢失分组、长延迟

方法

* 端到端拥塞控制：没有从网络中得到明确的反馈，从端系统观察到的丢失和延迟推断出拥塞，TCP采用的方法
* 网络辅助的拥塞控制：路由器给端系统提供反馈，单bit指示拥塞 (SNA, DECnet,  TCP/IP ECN, ATM)，指明发送者应该发送的速率

## 3.7 TCP拥塞控制

> TCP拥塞控制必考题

端到端控制，无网络辅助。 发送方限制发送: 
$$
LastByteSent-LastByteAcked<min( CongWin , RcvWindow ) \\
大体上：rate = \frac{CongWin}{RTT}Bytes/sec
$$
CongWin 是动态的, 感知的网络拥塞 的函数

发送方感知拥塞：丢失事件=超时或者 3 个重复的ACKs。TCP 发送方在丢失事件发生后降低发送速率 (CongWin)

三个机制

* 慢启动：指数倍增
* AIMD：发生丢包后拥塞窗口减半，一个RTT内没有丢失则窗口+MSS
* 对拥塞事件做出反应：从指数变化→线性增加

拥塞控制总结

* 当 CongWin 低于阀值, 发送方处于慢启动阶段, 窗口指数增长
* 当 CongWin 高于阀值, 发送方处于拥塞避免阶段, 窗口线性增长.
* 当三个重复的ACK 出现时,阀值置为CongWin/2 并且CongWin 置为 阀值加上3个MSS并进入快速恢复阶段，此时每收到一个重复的ACK 拥塞窗口增加1MSS，如果收到新的ACK则拥塞窗口置成阀值）
* 当超时发生时 ，阀值置为CongWin/2 并且CongWin 置为1 MSS.

TCP平均吞吐量

* 假设忽略慢启动，W窗口大小
* 吞吐量W/RTT
* 发生丢失后窗口降为W/2，吞吐量W/RTT
* 平均吞吐量0.75W/RTT

**********

# 4 网络层

> 重点-IP协议，IPV4子网划分
>
> 路由算法Djstla、距离向量算法

总结

* 网络层提供的服务和功能：主机通信；虚电路和数据报；转发 ；选路 
* 路由器工作原理 
* 网际协议IP 
  * IP报文、IP分片和重组
  * IP编址和IP子网 
  * P地址分类和无分类编址CIDR 
  * NAT网络地址转换
  * IPv6协议及特点
  * IPv4和IPv6互通
* 选路算法：链路状态选路算法；距离向量算法；层次选路
* 因特网中的选路协议
  * 内部网关协议：RIP、OSPF、IGRP
  * 外部网关协议：BGP
* SDN：概念，用途，架构；OpenFlow

## 4.5 路由和选路

> 啊？怎么直接4.5了

默认路由器：与主机直接相连的路由器，即第一跳路由器

路由算法

* 全局路由算法-链路状态路由算法LS
* 分布式路由算法-距离向量路由算法DV
* 静态路由算法
* 动态路由算法

链路状态选路算法-Dijkstra

* 需要知道所有节点的网络拓扑和费用信息

* 费用c(x,y)，源节点到v的费用D(v)，源节点到v的路径上的前驱节点p(v)，N‘已找到的最低费用路径的节点集合

* 计算：初始化N’={源节点u}，直连v则D(v)=c(u,v)，不直连则=∞→D(v)=min[D(v)，D(w)+c(w,v)]

  ![image-20230622113435541](https://github.com/LyrisLaurier/notes/assets/94295495/6647b116-57e8-4bbb-b04e-3538c1fb2b44)


* 最低费用路径树

  ![image-20230622113707287](https://github.com/LyrisLaurier/notes/assets/94295495/373ef7fb-57ef-444f-88a0-2e5ccee6c7f6)


* 转发表：存放从源节点到每个目的节点的最低费用路径上的下一跳节点。即指出对 于发往某个目的节点的分组，从该节点发出后的下一个节点

  ![image-20230622113806425](https://github.com/LyrisLaurier/notes/assets/94295495/6d0c863c-bc12-450d-bc63-7e63d010a7c6)


  还有一个例题

  ![image-20230622113847419](https://github.com/LyrisLaurier/notes/assets/94295495/8408d536-15f3-4ba1-887b-7e959ccdb8d9)


* 复杂度计算：第一次检查n个第二次n-1个……累积和n(n+1)/2→复杂度 $O(n^2)$

距离向量路由算法-DV

$$
d_x(y)=min_v\{c(x,v)+d_v(y)\}\\
d_x(y)节点x到y的最低费用，v是x的邻居节点
$$

![image-20230622120629489](https://github.com/LyrisLaurier/notes/assets/94295495/55a89a14-93eb-4e50-8ba4-b59fe1347e46)

节点的距离向量表

* 用 $D_x(y) = min_v {c(x,v)+ D_v(y)}$ 更新距离向量，距离向量不再变化就终止

  ```mermaid
  graph LR
  	x --2--- y --1--- z --7--- x
  ```

  ![image-20230622151405844](https://github.com/LyrisLaurier/notes/assets/94295495/4e9835aa-c4df-4a2c-9df1-08e3f9e7517e)


链路费用改变与链路故障

毒性逆转

> 这没太懂，看完概念回来再看计算

PPT-43后还有计算题可以

## 4.6 层次选路

域内路由协议/内部网关协议IGP

* 路由信息协议RIP
* 开放式最短路径优先OSPE
* 内部网关路由协议IGRP

RIP

* RIP通告：每隔30秒,通过响应报文在邻居间交换距离向量。每个通告包含了多达25个AS内的目的子网的列表
* 路由器上有转发表：目的子网-下一跳路由-到目的地的跳数

OSPF

BGP

> 这都是些啥啊。。。不想看

## 4.7 SDN

软件定义网络：一种新型网络创新架构，可通过 软件编程的形式定义和控制网络，具有控制平面和转发平面分离及 开放性可编程的特点。核心理念是希望应用软件可以参与对网络的控制管理，满足上层业务需求，通过自动化业务部署，简化网络运维

发展驱动力，优势

特征：基于流的转发；数据平面与控制平面分离；网络控制功能，位于数据平面交换机外部；可编程的网络

SDN控制器组件：针对网络控制应用的接口层，负责维护网络状态一致视图的状态管理层，通信层

OpenFlow：由OpenFlow网络设备、控制器、OpenFlow通道组成






