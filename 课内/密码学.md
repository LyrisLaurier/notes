# 第一章 引言

复习

* 密码学的基本概念
* 密码学的分类
* 密码体制攻击的四种类型
* 保密系统的安全性分析
* 古典密码算法

密码学基本概念：密码学是研究编制密码和破译密码的技术科学。研究密码变化的客观规律，应用于编制密码以保护通信秘密的，称为密码编码学

分类：

![image-20230523145038352](https://github.com/LyrisLaurier/notes/assets/94295495/b0e1ea92-a611-43e8-9653-57e904396f9b)

密码体制攻击：唯密文攻击，已知明文攻击，选择明文攻击，选择密文攻击

保密系统：由明文空间、密文空间、密钥空间、加密算法、解密算法构成。为了保护信息的保密性，抗击密码分析，保密系统应当满足下述要求：

1. 系统即使达不到理论上是不可破的，也应当为实际上不可破的。就是说，从截获的密文或某些已知明文密文对，要决定密钥或任意明文在计算上是不可行的。
2. 系统的保密性不依赖于对加密体制或算法的保密，而依赖于密钥。这是著名的 Kerckhoff原则。
3. 加密和解密算法适用于密钥空间中的所有元素。
4. 系统便于实现和使用。

攻击

* 唯密文攻击（Ciphertext Olny Attack）
* 已知明文攻击（Known Plaintext Attack）
* 选择明文攻击（Chosen Plaintext Attack）
* 选择密文攻击（Chosen Ciphertext Attack）

古典密码算法：

* 置换密码
* 单边代替密码算法
* 多表代替密码算法

# 第二章 流密码

重点

* 流密码的基本思想
* 伪随机序列要满足的条件
* 线性反馈移位寄存器序列的基本概念
  * m序列的定义
  * m序列的伪随机性



看笔记，这章笔记既得全

# 第三章 分组密码

重点

* 分组密码的设计准则
* 分组密码的安全需求
* 分组密码的四种工作模式
* DES算法的主要原理及参数
* AES算法的主要原理及参数
* SM4算法参数设置

安全性设计原则

* 混淆原则：将密文、明文、密钥三者之间的统计关系和代数关系变得尽可能复杂，使得敌手即使获得了密文和明文，也无法求出密钥的任何信息；即使获得了密文和明文的统计规律，也无法求出明文的新的信息
* 扩散原则：将明文的统计规律和结构规律散射到相当长的一段统计中去

分组密码满足

* 分组长度n足够大
* 密钥量足够大
* 由密钥确定置换的算法要足够复杂
* 加解密运算简单
* 数据扩展
* 差错传播尽可能小

分组密码主要工作模式

1. 电码本(ECB)模式
   * 优点：①实现简单；②不同明文分组的加密可并行实施，尤其是硬件实现时速度很快
   * 缺点：①相同明文分组对应相同密文分组；②不能隐蔽明文分组的统计规律和结构规律,不能抵抗替换攻击
   * 应用：①用于随机数的加密保护；②用于单分组明文的加密
2. 密码分组链接(CBC)模式
   * 特点：①明文块的统计特性得到了隐蔽。由于在CBC模式中，各密文块不仅与当前明文块有关，而且还与以前的明文块及初始化向量有关，从而使明文的统计规律在密文中得到了较好的隐藏；②具有有限的错误传播特性。一个密文块的错误将导致两个密文块不能正确解密；③具有自同步功能。密文出现丢块和错块不影响后续密文块的解密.若从第t块起密文块正确,则第t+1个明文块就能正确求出 
3. 密码反馈(CFB)模式
   * 特点：①相同明文：和按CBC模式加密一样，改变IV同样会导致相同的明文输入得到不同的加密输出。IV无需保密（虽在某些应用中IV须是不可预测的）。②链接依赖性：类似CBC加密，链接机制致使密文组依赖于当前明文组和其前面的明文组；因此，重排密文组会影响解密。③错误的传播：一个或多个比特错误出现在任一个r比特的密文组中会影响这个组和后继     个密文组的解密。④错误恢复：CFB和CBC相似，也是自同步的，但它需有 $[n/r]$ 个密文组才能还原
4. 输出反馈(OFB)模式
5. 计数器模式

# 第四章 公钥密码

重点：

* 公钥密码的基本思想
* RSA算法原理及相关安全性分析
* ElGamal算法原理及相关安全性分析
* SM2算法原理
* 选择密文攻击

RSA安全性

为保证算法的安全性，还对p和q提出以下要求：

1. |p-q| 要大。
2. p 和 q 的长度应该相差不多。
3. p-1 和 q-1 都应有大素因子。
4. gcd(p-1, q-1) 应该很小。

有限域上椭圆曲线

$$
y^2≡x^3+ax+b(mod p)   (a,b∈GF(p),4a^3+27b^2≠0(modp))​
$$

![image-20230526104031069](https://github.com/LyrisLaurier/notes/assets/94295495/31a2a1c3-cdbc-4cde-93e2-0b82acf64bcc)


SM2算法



# 第五章 MAC和Hash函数

重点

* 消息认证码的定义及构造
* 杂凑函数的定义及性质
* 杂凑函数设计的一般模式
* SHA1的分组长度、填充、摘要长度、迭代轮数
* SM3的分组长度、填充、摘要长度、迭代轮数

消息认证码/密码校验和：消息被一密钥控制的公开函数作用后产生的用作认证符的固定长度的数值

SHA-1

* 输入：小于 $2^{64}$  比特的消息，512比特一分组
* 输出：160比特（即摘要）
* 压缩函数：4轮，每轮20步迭代

SM3

* 输入：$2^{64}$ 比特，512比特一分组
* 输出：256比特
* 迭代64轮

# 第六章 数字签名

重点

* 数字签名应具有的特性
* RSA数字签名体制的原理、弱点及改进
* ElGamal数字签名体制
* DSS数字签名体制
* 交互式证明

数字签名特性

* 签名是可信的：任何人可验证签名的有效性。
* 签名是不可伪造的：除合法签名者外，其他人伪造签名是困难的。
* 签名是不可复制的：一消息的签名不能复制为另一消息的签名。
* 签名的消息是不可改变的：经签名的消息不能被篡改。
* 签名是不可抵赖的：签名者事后不能否认自己的签名。

RSA

* 签名见笔记
* 缺点：
  * 对任意 $y∈Z_n$，任何人可计算 $x≡y^e mod n$，因此任何人可伪造对随机消息*x*的签名。
  * 如果消息  x1和 x2 的签名分别为 y1 和 y2，则知道 x1、y1、x2,、y2 的人可伪造对消息 x1 x2 的签名 y1 y2 。
  * 在RSA签名方案中，需签名的消息 $x∈Z_n$，所以每次只能对 $[log_2n]$ 位长的消息进行签名。签名速度慢。
* 改进：签名之前求消息的Hash值

DSS和ElGamal签名见笔记

交互证明

* 证明者P、验证者V。P知道某一秘密（如公钥密码体制的秘密钥或一平方剩余x的平方根），P希望使V相信自己的确掌握这一秘密。
* 交互证明比较典型的方式：每轮V都向P发出一询问，P向V做出一应答。所有轮执行完后，V根据P是否在每一轮对自己发出的询问都能正确应答，以决定是否接受P的证明

Schnorr

Okamoto

# 第七章 密码协议

重点

* Diffie-Hellman密钥交换原理及安全性
* Shamir门限方案
* Kerberos协议
* 一次性口令协议





